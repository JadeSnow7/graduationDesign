# 毕业论文整体思路

## 论文题目
基于企业微信与大模型的高校《电磁场》课程智能教学平台设计与实现

---

## 研究问题与创新目标

### 核心研究问题（RQ）
1. 如何在理工科推导型问题中降低幻觉，并保证公式与数值的可验证性？
2. 如何构建可追溯的课程知识检索机制，支持多跳关联与来源标注？
3. 如何让模型输出符合教学风格与课程语境，实现“解释 + 证据 + 计算”的一致性？
4. 如何将作业、讨论与讲义等多源数据快速纳入知识库并保持更新？

### 创新目标（可验证）
- 构建“工具调用 + GraphRAG + 后训练”的三位一体框架，并通过消融实验验证各组件贡献。
- 建立证据链（引用来源）与计算链（工具结果）的双重可追溯机制。
- 形成可复用的数据索引与质量评估流程，支撑持续迭代。

---

## 创新路径总览
┌─────────────────────────────────────────────────────────────┐
│   工具调用 (Tool Calling)    │    GraphRAG     │   后训练模型   │
│   可验证的计算能力            │  可追溯的知识检索  │  领域适配推理   │
├─────────────────────────────┼─────────────────┼───────────────┤
│ • 符号计算 / 数值仿真         │ • 混合检索      │ • LoRA 微调   │
│ • 公式验证                   │ • 图扩展推理     │ • 教学风格    │
│ • 精确计算避免幻觉            │ • 来源追溯[1][2] │ • CoT 推理链  │
└─────────────────────────────┴─────────────────┴───────────────┘

---

## 论文章节结构

### 第一章 绪论（约5000字）

#### 1.1 研究背景与意义
- 《电磁场》课程教学痛点：概念抽象、推导复杂、答疑需求大
- 大模型与企业微信技术发展为智能教学提供契机
- 教学实践、技术应用与学术价值三重意义

#### 1.2 国内外研究现状
- 学习管理系统（LMS）与学习分析
- 教育大模型与对话式辅导
- 检索增强生成（RAG）与 **GraphRAG**（重点）
- 可视化与仿真教学

#### 1.3 研究目标与内容
- 五大目标：前端、后端、AI服务、仿真服务、可评估架构
- 四大模块内容概述

#### 1.4 论文组织结构
- 各章内容摘要

---

### 第二章 相关技术与理论基础（约6000字）

#### 2.1 前端技术
- Vue 3 + Vite + TypeScript
- 企业微信 H5 内嵌与适配

#### 2.2 后端技术
- Go + Gin 框架
- 分层架构（Handler/Service/Repo）
- RBAC 权限模型与 JWT 认证

#### 2.3 大语言模型与检索增强
- Transformer 与 LLM 基础
- 传统 RAG 原理与局限
- **GraphRAG 核心思想**（本论文重点技术）
  - 知识图谱结构（节点-边-片段）
  - 混合检索（关键词 + 语义）
  - RRF 融合排序
  - 多跳推理与图扩展

#### 2.4 数值仿真与可视化
- 电磁场数值方法（有限差分）
- Python 科学计算生态（NumPy/SciPy/Matplotlib）

#### 2.5 工具调用与后训练
- Tool Calling 工作流与函数调用规范
- SFT/LoRA 等后训练方法与数据格式
- 可信度与一致性评估指标

---

### 第三章 系统需求分析与总体设计（约4000字）

#### 3.1 需求分析
- 用户角色：管理员、教师、助教、学生
- 功能需求：教学管理、AI辅助、仿真演示
- 非功能需求：性能、安全、兼容性

#### 3.2 系统总体架构
```
┌─────────────────────────────────────────────────────────────┐
│                        客户端层                              │
│  企业微信客户端 (WebView)  │  普通浏览器 (Chrome/Edge)      │
└─────────────────────────────────────────────────────────────┘
                                │
┌─────────────────────────────────────────────────────────────┐
│                        前端层                                │
│              Vue 3 + TypeScript H5 应用                     │
└─────────────────────────────────────────────────────────────┘
                                │ HTTP/JSON
┌─────────────────────────────────────────────────────────────┐
│                        网关层                                │
│                   Go + Gin 后端服务                         │
│  鉴权 │ 权限 │ 课程API │ AI网关 │ 仿真网关                   │
└─────────────────────────────────────────────────────────────┘
                                │
┌─────────────────────────────────────────────────────────────┐
│                        服务层                                │
│    AI 服务 (FastAPI)    │    仿真服务 (FastAPI)            │
│  大模型对接 │ GraphRAG   │  数值计算 │ 可视化输出            │
└─────────────────────────────────────────────────────────────┘
```

#### 3.3 数据库设计
- ER 图
- 核心表结构

#### 3.4 接口设计
- RESTful API 规范
- 服务间通信协议

---

### 第四章 智能辅助推理系统设计与实现（约10000字）⭐核心章节

> **核心理念**：构建"工具调用 + RAG + 后训练"三位一体的辅助推理框架，
> 使 AI 具备**可验证的计算能力**、**可追溯的知识检索**和**领域适配的推理能力**。

#### 4.1 问题分析：大模型在理工科教学的挑战

##### 4.1.1 幻觉问题
- 大模型生成看似合理但错误的公式/数值
- 例：静电场边界条件推导中的常数错误

##### 4.1.2 推理链断裂
- 复杂推导过程中跳步或逻辑错误
- 例：从 Maxwell 方程推导波动方程的中间步骤

##### 4.1.3 知识时效性
- 预训练知识截止，无法获取最新课程内容
- 例：教师新增的习题和讲义

#### 4.2 三位一体辅助推理框架

```
┌─────────────────────────────────────────────────────────────────┐
│                      用户查询（学生/教师）                        │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                    意图理解与路由层                               │
│  判断查询类型：概念解释 / 公式推导 / 数值计算 / 综合问答            │
└─────────────────────────────────────────────────────────────────┘
                                │
        ┌───────────────────────┼───────────────────────┐
        ▼                       ▼                       ▼
┌───────────────┐     ┌───────────────┐     ┌───────────────┐
│   工具调用     │     │   GraphRAG    │     │   后训练模型   │
│  Tool Calling │     │   检索增强     │     │ Fine-tuned LLM│
├───────────────┤     ├───────────────┤     ├───────────────┤
│ • 符号计算     │     │ • 混合检索     │     │ • LoRA 微调   │
│ • 数值仿真     │     │ • 图扩展推理   │     │ • 领域适配    │
│ • 公式验证     │     │ • 来源追溯     │     │ • 教学风格    │
└───────────────┘     └───────────────┘     └───────────────┘
        │                       │                       │
        └───────────────────────┼───────────────────────┘
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                    响应融合与质量控制                             │
│  • 计算结果嵌入回答  • 引用标注  • 置信度评估  • 教学化表达         │
└─────────────────────────────────────────────────────────────────┘
```

**质量控制要点**：
- 引用一致性校验：回答中的引用编号必须与检索片段一一对应
- 计算一致性校验：关键数值来自工具调用或仿真结果
- 低置信拒答：证据不足时显式提示并给出补充信息需求

**路由策略（示意）**：
- 概念/原理类问题优先走 GraphRAG
- 公式推导与数值计算优先走工具调用
- 综合问题采用“检索→推导→计算”链式组合

---

#### 4.3 工具调用（Tool Calling）：可验证的计算能力

##### 4.3.1 工具类型设计
| 工具名称 | 功能 | 输入示例 | 输出示例 |
|---------|------|---------|---------|
| `calculate_integral` | 符号/数值积分 | `∫E·dl from 0 to R` | `V = -Q/(4πε₀R)` |
| `calculate_derivative` | 符号/数值微分 | `∇×E` | `curl_E = ...` |
| `evaluate_expression` | 表达式求值 | `ε₀ * 8.85e-12` | `数值结果` |
| `vector_operation` | 矢量运算 | `grad, div, curl, laplacian` | `符号结果` |
| `run_simulation` | 运行仿真 | `laplace2d, params={}` | `图像URL + 数据` |

##### 4.3.2 工具调用流程
```python
# 伪代码示意
def chat_with_tools(query, tools):
    # 1. LLM 判断是否需要调用工具
    response = llm.generate(query, tools=tools)
    
    # 2. 如果返回 tool_call，执行工具
    if response.tool_calls:
        for call in response.tool_calls:
            result = execute_tool(call.name, call.args)
            # 3. 将工具结果注入上下文
            messages.append(tool_result_message(result))
        
        # 4. 让 LLM 基于工具结果生成最终回答
        final = llm.generate(messages)
    return final
```

##### 4.3.3 工具调用优势
- **精确计算**：避免大模型"心算"错误
- **可验证性**：计算过程可复现、可检验
- **扩展性**：可添加更多领域工具

---

#### 4.4 GraphRAG：可追溯的知识检索

##### 4.4.1 知识图谱构建
```
章节          概念           公式              物理量
  │             │              │                 │
  ▼             ▼              ▼                 ▼
┌────┐     ┌────────┐     ┌──────────┐     ┌─────────┐
│Ch1 │────▶│静电场   │────▶│∇·D = ρ   │────▶│电位移矢量│
└────┘     └────────┘     └──────────┘     └─────────┘
              │                │
              ▼                ▼
         ┌────────┐     ┌──────────┐
         │边界条件 │◀────│n×(E₁-E₂)=0│
         └────────┘     └──────────┘
```

##### 4.4.2 混合检索策略
1. **关键词检索**：Bigram 匹配，捕获精确术语
2. **语义检索**：向量相似度，捕获语义相关
3. **RRF 融合**：`score = 1/(k+rank₁) + 1/(k+rank₂)`

##### 4.4.3 图扩展推理
- 从检索到的片段出发，沿边扩展 1-2 跳
- 获取前置概念和相关公式
- 构建完整的推导上下文

##### 4.4.4 来源追溯
- 回答中使用 `[1][2]` 标注引用来源
- 防止幻觉，提升可信度

##### 4.4.5 多源数据与增量更新
- 讲义、作业、讨论与 FAQ 统一为可检索片段
- 新增内容触发增量索引更新，保证知识时效性
- 支持用户/课程级过滤，避免跨课程泄露

---

#### 4.5 后训练（Post-Training）：领域适配的推理能力

##### 4.5.1 后训练目标
| 目标 | 说明 | 方法 |
|------|------|------|
| 领域知识强化 | 电磁场专业术语、公式符号 | Continue Pre-training |
| 教学风格适配 | 循序渐进、类比解释 | SFT (Supervised Fine-tuning) |
| 工具调用能力 | 正确识别何时调用工具 | Tool-use SFT |
| 推理链优化 | 结构化推导步骤 | CoT (Chain-of-Thought) SFT |

##### 4.5.2 数据集构建
```json
// 教学问答数据示例
{
  "instruction": "请解释电磁场边界条件",
  "input": "",
  "output": "电磁场边界条件描述了...\n\n**切向分量**：...\n**法向分量**：...\n\n参考 [1] 第二章 2.3 节"
}

// 工具调用数据示例
{
  "instruction": "计算半径为 R 的均匀带电球面外某点电势",
  "input": "R=0.1m, Q=1e-9C, r=0.2m",
  "output": "<tool_call>calculate_integral(...)</tool_call>\n\n根据计算结果，电势 V = 45V"
}
```

##### 4.5.3 LoRA 微调方案（推荐）
- **参数效率**：仅训练约 0.1% 参数
- **低成本**：单 GPU 可完成训练
- **可叠加**：多个 LoRA 适配器可组合

```python
# LoRA 配置示例
lora_config = LoraConfig(
    r=16,                    # LoRA 秩
    lora_alpha=32,           # 缩放因子
    target_modules=["q_proj", "v_proj"],
    lora_dropout=0.05,
    task_type="CAUSAL_LM"
)
```

##### 4.5.4 评估指标
- **教学质量**：人工评分（准确性、清晰度、教学性）
- **工具调用准确率**：正确识别调用时机
- **引用正确率**：回答引用与检索片段的一致性
- **计算正确率**：数值结果与工具输出一致
- **幻觉率**：与标准答案对比

---

#### 4.6 三者协同工作流程

```
用户问题: "推导平面波在导体表面的反射系数公式，并计算铜(σ=5.8e7)在1GHz时的反射系数"
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────┐
│ Step 1: 意图理解（后训练模型）                                     │
│ → 识别为"公式推导 + 数值计算"复合任务                               │
└─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────┐
│ Step 2: 知识检索（GraphRAG）                                      │
│ → 检索相关片段：                                                   │
│   [1] 平面波边界条件 (docs/ch5.md#5.2)                            │
│   [2] 导体表面电磁波特性 (docs/ch5.md#5.3)                         │
│   [3] 反射系数定义 (docs/ch5.md#5.4)                              │
└─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────┐
│ Step 3: 公式推导（后训练模型 + RAG 上下文）                          │
│ → 基于 [1][2][3] 进行推导，标注引用                                 │
│ → 得到反射系数公式: Γ = (η₂-η₁)/(η₂+η₁)                           │
└─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────┐
│ Step 4: 数值计算（工具调用）                                       │
│ → 调用 evaluate_expression 计算铜的表面阻抗                         │
│ → 调用 evaluate_expression 计算反射系数                            │
│ → 结果: |Γ| ≈ 0.9999                                             │
└─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────┐
│ Step 5: 响应生成（后训练模型）                                      │
│ → 整合推导过程和计算结果                                            │
│ → 添加物理解释：为什么铜是良导体，反射系数接近1                        │
│ → 标注引用: [1][2][3]                                             │
└─────────────────────────────────────────────────────────────────┘
```

---

#### 4.7 实现细节

##### 4.7.1 代码模块
| 模块 | 文件 | 功能 |
|------|------|------|
| 嵌入层 | `embedding.py` | API/本地嵌入模型抽象 |
| 向量存储 | `vector_store.py` | FAISS + 元数据过滤 |
| 检索层 | `retrieve.py` | 混合检索 + RRF + 图扩展 |
| 更新层 | `updater.py` | 在线热更新 |
| 工具层 | `tools.py` | 工具定义与执行 |
| 技能层 | `skills/` | Prompt 模板管理 |
| 质量控制 | `quality_guard.py` | 引用/计算一致性与置信度控制 |
| 评估层 | `eval/` | 基准集与评测脚本 |

##### 4.7.2 API 端点
| 端点 | 方法 | 功能 |
|------|------|------|
| `/v1/chat` | POST | 基础对话（关键词 RAG） |
| `/v1/chat/hybrid` | POST | 混合检索对话 |
| `/v1/chat_with_tools` | POST | 工具调用对话 |
| `/v1/graphrag/index` | POST/DELETE | 索引管理 |

---

#### 4.8 消融实验设计（用于评估各组件贡献）

| 配置 | 工具调用 | GraphRAG | 后训练 | 预期效果 |
|------|---------|----------|--------|---------|
| Baseline | ✗ | ✗ | ✗ | 纯 LLM，幻觉多 |
| +RAG | ✗ | ✓ | ✗ | 减少幻觉，但计算仍不准 |
| +Tool | ✓ | ✗ | ✗ | 计算准确，但知识不足 |
| +RAG+Tool | ✓ | ✓ | ✗ | 知识+计算，但表达不够教学化 |
| Full | ✓ | ✓ | ✓ | 完整系统，综合最优 |


---

### 第五章 教学管理模块设计与实现（约5000字）

#### 5.1 用户与权限管理
- RBAC 模型实现
- JWT 认证流程

#### 5.2 课程管理
- 课程 CRUD
- 成员管理与邀请码

#### 5.3 作业管理
- 作业发布与提交
- 批改与反馈
- 成绩统计

#### 5.4 考勤签到
- 签到机制
- 出勤统计

---

### 第六章 AI教学辅助模块设计与实现（约5000字）

#### 6.1 智能答疑（Tutor Mode）
- Prompt 设计
- RAG 增强策略

#### 6.2 作业批改辅助（Grader Mode）
- 评分细则匹配
- 错误诊断与建议

#### 6.3 学情分析
- 薄弱点分析
- 教学建议生成

#### 6.4 仿真结果解读
- 图像理解
- 教学化表达

---

### 第七章 仿真子系统设计与实现（约4000字）

#### 7.1 典型模型选择
- 二维静电场（Laplace 方程）
- 平面波传播

#### 7.2 数值求解方法
- 有限差分法
- 迭代求解

#### 7.3 可视化输出
- 等势线图
- 电场矢量图

#### 7.4 与 AI 协同
- 参数解释
- 结果引导

---

### 第八章 系统测试与评估（约4000字）

#### 8.1 测试环境
- 硬件配置
- 软件环境

#### 8.2 功能测试
- 各模块测试用例
- 测试结果

#### 8.3 性能测试
- API 响应时间
- 并发能力
- AI/仿真响应时间

#### 8.4 GraphRAG 检索质量评估
- 基准查询集构建
- 召回率与相关性指标（Recall@k、MRR、NDCG）
- 与传统 RAG 对比

#### 8.5 可信度与计算准确性评估
- 引用正确率：引用片段是否真实存在且匹配结论
- 计算正确率：工具调用结果与最终答案一致
- 组件消融对比：纯 LLM / +RAG / +Tool / Full

#### 8.6 用户体验评估（可选）
- 问卷或访谈

---

### 第九章 结论与展望（约2000字）

#### 9.1 工作总结
- 完成的主要工作
- 创新点归纳

#### 9.2 不足与展望
- 当前局限
- 未来改进方向

---

## 论文亮点与创新点

1. **三位一体可验证推理框架**：工具调用 + GraphRAG + 后训练协同，兼顾计算正确性、知识可追溯与教学表达。
2. **证据链 + 计算链双重可追溯**：答案同时标注引用片段与工具计算结果，降低幻觉并提升可验证性。
3. **混合检索与图扩展融合**：关键词/语义双路检索 + RRF 融合 + 多跳扩展，提升相关性与推导完整性。
4. **多源教学数据统一索引**：讲义、作业、讨论、FAQ 统一片段化索引并支持增量更新与 ACL 过滤。
5. **教学风格领域适配**：基于 SFT/LoRA 的教学话术与推导步骤强化，减少“答案式”输出。
6. **AI + 仿真协同闭环**：将数值仿真结果作为可验证证据注入回答，提高理工科问题解释力。
7. **可评估的质量闭环**：构建基准查询集与消融实验，量化组件贡献与性能边界。

---

## 写作建议

| 章节 | 建议字数 | 优先级 |
|------|---------|--------|
| 第四章（GraphRAG）| 8000 | ⭐⭐⭐ 最重点 |
| 第二章（理论基础）| 6000 | ⭐⭐ |
| 第五章（教学管理）| 5000 | ⭐⭐ |
| 第六章（AI辅助）| 5000 | ⭐⭐ |
| 第一章（绪论）| 5000 | ⭐ |
| 第七章（仿真）| 4000 | ⭐ |
| 第八章（测试）| 4000 | ⭐ |
| 第三章（总体设计）| 4000 | ⭐ |
| 第九章（结论）| 2000 | ⭐ |

**总计约 43000 字**（符合本科毕业论文要求）
